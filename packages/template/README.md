# Bizzell App

This readme outlines all the configuration you'll need to get up and running with an application generated using `@bizzell/create-bizzell-app`. First, you'll need to make sure `node.js` is installed on your machine along with a recent version of `npm`. We recommend using Visual Studio Code (not to bee confused with Visual Studio) and Git to get the best tooling and support.

### To Install Node:

Go to https://nodejs.org/en/download and download applicable version for your machine and project

### To Install VS Code:

Go to https://code.visualstudio.com/download and download applicable version for your machine

## Contents

- [Under the Hood](#under-the-hood)
- [Architecture](#architecture)
- [Workflow](#workflow)
- [Contributing](#contributing)
- [Managing VS Code](#managing-vs-code)
- [Managing State with Redux](#managing-state-with-redux)
- [Testing](#testing)

## Under the Hood

[Back to contents](#contents)

- `React`: Most popular UI library/framework in the world, and for good reason.
- `Rollup`: javascript bundler which, as of Feb. 2018, `Rollup` supports the code splitting and dynamic imports we need to do our jobs correctly.
  <!-- TODO add Webpack info-->
- `Jest`: Test runner that just works. UI can be difficult to test, but `Jest` will be invaluable if we add `redux` or other abstractions.
- `Typescript`: language pragma which adds type declarations to javascript. It has a structural, algebraic type system.

## Architecture

[Back to contents](#contents)

### json files

#### package.json

Contains project details and dependencies. Read [npm documentation](https://docs.npmjs.com/) to learn more.

#### package-lock.json

Automatically generated file. Do not edit this manually, but do track it on GitHub.

### Actions folder

Folder to hold redux actions. You will likely only need the index file.

### Reducers folder

Folder to hold redux reducers. You will likely only need the index file.

### Components folder

Folder to hold react components. Ideally this is where most of your work in the code happens.

### Any other important files

#### App.tsx

The main app.

<!-- TODO add more info -->

#### AppRouter.tsx

<!-- TODO add information about AppRouter -->

#### configureStore.ts

The entry point for redux state store. For more information, see [Managing State with Redux](#managing-state-with-redux).

#### index.tsx

The entry point for the application.

## Workflow

[Back to contents](#contents)

Assert that you have `node` installed. Open the project directory in a terminal or command prompt. The first time you open the project and anytime the project's dependencies change, you'll need to run:

```bash
npm install
```

This fetches all the project dependencies and lobs thim into the `node_modules` directory. Note that `package-lock.json` is autogenerated and exists to keep our dependencies in sync, so you shouldn't have to run `npm install` often.

Use the following commands (specified in `package.json#scripts`) to interact with and the project.

```bash
# Run Jest tests:
npm run test

# Run dev mode serve:
# Recompiles on save,
# Automatically opens in browser.
npm run dev

# Run prod mode build:
# Compile with minification,
# compression, and prod sources.
npm run build
```

You should be able to configure your work environment to autoformat files on save using the `prettier` configuration found in `package.json` (using the `prettier` extension in `VSCode`, for example). @DuncanWalter would also like to add linting support.

All git commits are guarded by a `husky` precommit check which runs tests and makes sure `prettier` has run over all the files.

## Contributing

[Back to contents](#contents)

- Never work on the `master` branch
- use feature based, kebab-cased names for branches
- Never merge a pull request without review and approval
- Review others' code
- Use 'squash and merge' when merging pull requests
- Prefer `git rebase` over `git merge`
- When making pull requests with UI changes, include screenshots

## Managing VS Code

[Back to contents](#contents)

- [Configure settings](#to-configure-settings-in-vs-code)
- [Get extensions](#to-get-extensions-in-vs-code)
- [Manage extensions](#to-manage-extensions-in-vs-code)

### To Configure Settings in VS Code:

There are two types of settings VS Code provides - User (these apply globally to any instance of VS Code you open) and Workspace (these settings are stored inside your workspace in a .vscode folder and will only be applied when the workspace is opened)

To configure the desired settings go to File > Preferences > Settings (Code > Preferences > Settings on a Mac) for both user and workspace settings. Your changes will go into effect after the settings.json file has been saved.

In Windows the Settings File is located at %APPDATA%\Code\User\settings.json

On a Mac the Settings File is located at $HOME/Library/Application Support/Code/User/settings.json

In Linux the Settings File is at $HOME/.config/Code/User/settings.json

For the workspace settings file, go to the .vscode folder within your project

### To Get Extensions in VS Code:

- Step 1. Bring up the Extensions view by clicking the Extensions icon (a square icon usually at the bottom of the icon list) in the Activity Bar on the side of the VS Code platform or use the command (Ctrl + Shift + X)

- Step 2. Browse the various extensions until you find the one you want. In order to see a more in-depth explanation of any extension simply click on its name to open a side view which will give you the details, contributions, changelog, and dependencies of the chosen extension. When you've found what you want click the Install button next to the chosen extension.

- Step 3. In order for your downloaded extensions to take effect in VS Code click the Reload button that appears after the extension is successfully downloaded. This will restart VS Code and allow your extension to be used.

### To Manage Extensions in VS Code:

#### To List Installed Extensions:

Open the More Actions (…) drop-down menu and select 'Show Installed Extensions'. This will show you all installed extensions.

#### To Uninstall an Extension:

Click the gear button on the right of an extension entry and choose Uninstall from the drop-down menu. Then reload VS Code when prompted to uninstall the extension on your machine.

#### To Disable an Extension:

Click the gear button on the right of an extension entry and choose Disable or Disable (Workspace) {this will only disable the extension for your current workspace}. Then reload VS Code when prompted to disable the extension.

#### To Enable an Extension:

Click the gear button on the right of an extension entry and choose Enable or Enable (Workspace). Then reload VS Code when prompted to enable the extension.

#### To Automatically Update Extensions:

VS Code checks for updates on extensions and automatically installs them. You'll know an extension has been updated if you are prompted to reload VS Code.

#### To Update Extensions Manually:

If auto-update of extensions is disabled (accomplished by setting extensions.autoUpdate to false). Open the More Actions (…) drop-down menu and select 'Show Outdated Extensions' then click the Update button on the extensions you'd like to update. You will then be prompted to reload VS Code so the update can go into effect.

<!-- ## To Get Existing NPM Scripts to Interact With Current Libraries:

To run any script (created in the package.json of your project and will look like:

"scripts:" {
"script_name" : "file_you_want_script_to_run",
"script_name" : "file_you_want_script_to_run",
"script_name" : "file_you_want_script_to_run"
}

) simply run 'npm run script_name' in the terminal. -->

## Managing State with Redux

[Back to contents](#contents)

- [Add variables to state](#to-add-variables-to-state)
- [Add actions to modify state](#to-add-actions-to-modify-state)
- [Connect a component to state](#to-connect-a-component-to-state)
- [Use actions to modify state](#to-use-actions-to-modify-state)
- [Access variables from state](#to-access-variables-from-state)
- [Learn more](#to-learn-more)

### To Add Variables to State

Go to `src/configureStore.ts`. In the AppState interface, add variables with the format `varName: varType`.

Then go to `src/reducers/index.ts`. In initialState, add starting variables with the format `varName: value,`.

### To Add Actions to Modify State

Go to `src/actions/index.ts`. Add functions using the format provided. All actions will need a type. If you want the action to accept additional arguments or store additional variables you can modify the AppAction interface.

Then go to `src/reducers/index.ts`. Add a case to the switch statement for the type of action you added. The state returned will be the new state after the action.

### To Connect a Component to State

Add the following import statements:

```javascript
import { AppState } from '<path to src>/configureStore'
import { connect } from 'react-redux'
```

Add the function `mapStateToProps`. This can return the whole state or just certain variables. Then connect and export the component.

```javascript
function mapStateToProps(state: AppState) {
    return { ...state }
}

const ConnectedComponent = connect(
    mapStateToProps,
    dispatch => ({dispatch}),
)(ComponentName)

export ConnectedComponent
```

### To Use Actions to Modify State

Make sure the component is connected to the state.

Add the following import statements.

```javascript
import { Dispatch } from 'redux'
import { <desiredActions> } from '<path to src>/actions'
```

Add an interface for props and allow props to be passed to the component.

```javascript
interface ComponentProps extends AppState {
  dispatch: Dispatch;
}

class ComponentName extends Component<ComponentProps> {}
```

To actually use an action you will need the following code.

```javascript
const { dispatch } = this.props
dispatch(actionName())
```

### To Access Variables from State

Make sure the component is connected to the state and that the variables you want to access are included in `mapStateToProps`. Then you can access the variable using `this.props.variableName`.

### To Learn More

Redux documentation: https://react-redux.js.org/

## Testing

### To run a test

Execute the command npm run test in terminal.

### To create a test

Ensure that test file names follow the format of 'filename'.test.ts/tsx.

Add the following import statements:

```javascript
import { cleanup } from 'react-testing-library'
import React from 'react'
import Enzyme from 'enzyme'
import { mount } from 'enzyme'
import Adapter from 'enzyme-adapter-react-16'
import ComponentYouWouldLikeToTest from './ComponentYouWouldLikeToTest'
```

Configure and set up react-testing-library's cleanup function:

```javascript
Enzyme.configure({ adapter: new Adapter() })

afterEach(cleanup)
```

Then component test/s can be implemented. Documentation regarding the specifics of React testing can be found at the following:

https://jestjs.io/docs/en/tutorial-react
https://github.com/kentcdodds/react-testing-library

[Back to contents](#contents)
